"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.logFormatter = void 0;
const winston_1 = require("winston");
exports.logFormatter = winston_1.format.printf(({ level, message, label, timestamp, metadata }) => {
    try {
        const len = Object.keys(metadata).length - 1;
        const stack = metadata.stack || metadata[len];
        message = (typeof message === 'object') ? JSON.stringify(message) : message;
        if (metadata[len])
            delete metadata[len];
        if (metadata.stack)
            delete metadata.stack;
        const jsonmeta = (Object.keys(metadata).length !== 0) ? JSON.stringify(metadata) : '';
        if (stack) {
            const { filename, line, method, timestamp } = stack;
            return `${timestamp} ${level}: ${message} ${jsonmeta} ${method} ${filename} ${line}`;
        }
        else {
            return `${timestamp} ${level}: ${message} ${jsonmeta}`;
        }
    }
    catch (e) {
        return `${timestamp} ${level}: ${message}`;
    }
});
